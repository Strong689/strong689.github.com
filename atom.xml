<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  
  <title><![CDATA[Step by Step, Learning by Doing]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://strong689.github.com//"/>
  <updated>2015-07-20T01:25:01.986Z</updated>
  <id>http://strong689.github.com//</id>
  
  <author>
    <name><![CDATA[Strong :) Just Code it...]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Step into Mongoosejs-I First Step]]></title>
    <link href="http://strong689.github.com/2015/07/19/Mongoosejs-I/"/>
    <id>http://strong689.github.com/2015/07/19/Mongoosejs-I/</id>
    <published>2015-07-20T00:00:55.000Z</published>
    <updated>2015-07-20T01:25:01.986Z</updated>
    <content type="html"><![CDATA[<p><strong>Mongoose</strong>: elegant <strong>MongoDB</strong> object modeling for node.js.</p>
<h3 id="Installation">Installation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$npm</span> instll mongoose -g</span><br></pre></td></tr></table></figure>
<h3 id="Connection_to_MongoDB">Connection to MongoDB</h3><p>best practice: opening connection at application start<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// refer mongoos</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">"mongoose"</span>);</span><br><span class="line"><span class="comment">// open a connection to a specific server.db</span></span><br><span class="line"><span class="keyword">var</span> connectionString = <span class="string">"mongodb://locahost:27017/testDB"</span>;</span><br><span class="line">mongoose.connect(connectionString);  <span class="comment">//default connection</span></span><br><span class="line"><span class="keyword">var</span> connection1 = mongoose.coFateConnection</span><br><span class="line"><span class="keyword">var</span> connectionString2 = <span class="string">"mongodb://locahost:27017/DB2"</span>;</span><br><span class="line"><span class="keyword">var</span> connection2 = mongoose.createConnection(connectionString2);</span><br></pre></td></tr></table></figure></p>
<p>Format of connection string / Options of connection<br>  Format: mongodb://username:password@domain:port/db  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//JSON objects, Options definition</span></span><br><span class="line"><span class="keyword">var</span> connectionOptions = &#123;</span><br><span class="line">	<span class="string">'username'</span>: <span class="string">"db user name"</span>,</span><br><span class="line">	<span class="string">'password'</span>: <span class="string">"db pwd"</span></span><br><span class="line">&#125;;</span><br><span class="line">mongoose.connect(connectionString,connectionOptions);</span><br></pre></td></tr></table></figure>
<h3 id="Close_connection">Close connection</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// to close default connection</span></span><br><span class="line">mongoose.connection.close(callback); </span><br><span class="line"><span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'Mongoose\'s connection is closed!'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//alternative way to close</span></span><br><span class="line">connection1.close(callback);</span><br><span class="line">connection2.close(callback);</span><br></pre></td></tr></table></figure>
<h3 id="Events_of_Connection">Events of Connection</h3><p>three events </p>
<ul>
<li>connected</li>
<li>disconnected</li>
<li>error<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// how to catch events</span></span><br><span class="line">connection1.on(<span class="string">'error'</span>,callback);</span><br><span class="line"><span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'[EventName] occur!!'</span>)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><a href="mongoosejs.com">1</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><strong>Mongoose</strong>: elegant <strong>MongoDB</strong> object modeling for node.js.</p>
<h3 id="Installation">Installation</h3><figu]]>
    </summary>
    
      <category term="MongoDB" scheme="http://strong689.github.com/tags/MongoDB/"/>
    
      <category term="Mongoosejs" scheme="http://strong689.github.com/tags/Mongoosejs/"/>
    
      <category term="Step Into" scheme="http://strong689.github.com/categories/Step-Into/"/>
    
      <category term="MongoDB" scheme="http://strong689.github.com/categories/Step-Into/MongoDB/"/>
    
      <category term="Mongoosejs" scheme="http://strong689.github.com/categories/Step-Into/MongoDB/Mongoosejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[eCommerce Design by MongoDB]]></title>
    <link href="http://strong689.github.com/2015/07/18/eCommerce-Design-by-MongoDB/"/>
    <id>http://strong689.github.com/2015/07/18/eCommerce-Design-by-MongoDB/</id>
    <published>2015-07-18T18:03:58.000Z</published>
    <updated>2015-07-19T22:21:40.555Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>电商参考架构</p>
</blockquote>
<h3 id="[搭建灵活-可搜索-响应快速的产品目录系统][1]">[搭建灵活-可搜索-响应快速的产品目录系统][1]</h3><blockquote>
<p>大数据量电商如何使用MongoDB作为一个庞大产品目录持久层的一些最佳实践<br>  多功能商品目录系统的建模和索引的最佳实践，包括商品及商品系列的查询、店铺价格以及支持多样化搜索的目录浏览 </p>
<ul>
<li>对商品的搜索</li>
<li>对商品系列的搜索</li>
<li>对商品在每个店铺价格的检索</li>
<li>允许目录的多方面搜索和浏览</li>
</ul>
</blockquote>
<h4 id="商品数据模型">商品数据模型</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//definition: db.product， 只展示了对每件商品而言最重要的信息，例如类别、品牌以及描述：</span></span><br><span class="line">&#123;</span><br><span class="line">	“_id”: “<span class="number">30671</span>”, <span class="comment">//main item ID</span></span><br><span class="line">	“department”: “Shoes”,</span><br><span class="line">	“category”: “Shoes/Women/Pumps”,</span><br><span class="line">	“brand”: “Calvin Klein”,</span><br><span class="line">	“thumbnail”: “http:<span class="comment">//cdn.../pump.jpg”,</span></span><br><span class="line">	“title”: “Evening Platform Pumps”,</span><br><span class="line">	“description”: “Perfect <span class="keyword">for</span> a casual night out or a formal event.”,</span><br><span class="line">	“style”: “Designer”,</span><br><span class="line">	…</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//find by ID</span></span><br><span class="line">db.product.findOne(&#123;_id:<span class="string">"30671"</span>&#125;);</span><br><span class="line"><span class="comment">//find by serias IDs</span></span><br><span class="line">db.product.findOne(&#123;_id:&#123;$<span class="keyword">in</span>:[<span class="string">"30617"</span>,<span class="string">"45212"</span>]&#125;&#125;);  <span class="comment">//$in operator</span></span><br><span class="line"><span class="comment">//find by </span></span><br><span class="line">db.product.findOne(&#123;category:<span class="regexp">/^Shoes/</span>Women/&#125;);		<span class="comment">// regular express</span></span><br></pre></td></tr></table></figure>
<h4 id="系列数据模型">系列数据模型</h4><blockquote>
<p>对产品目录而言另一个重要的考量是商品系列，例如现有尺寸、颜色以及风格。<br>  对现有的、也许需要检索的商品系列（例如大小和颜色）而言的处理方法：</p>
<ul>
<li>在一个单一文档中存储一个商品以及它所有的系列<br>这种方法拥有能够在一个单一查询中检索一个商品以及其所有系列的优点。<br>然而，它并不是在所有情况下都是最好的方法。避免无限制的文档增长是一个非常重要的最佳实践。<br>如果产品系列的数据以及它们相关数据非常小，在商品文档中存储这些数据也许会有意义。</li>
<li>创建一个能够关联到主商品的、单独的系列数据模型 (pefer)</li>
</ul>
<p>维护了在目录中展示主商品以及当用户请求一个更详细的产品视图时对每个系列的快速查询。<br>  也可以保证商品以及系列文档的一个可预测大小</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//definition: db.variantion  //关联到主商品的、单独的系列数据模型</span></span><br><span class="line">&#123;</span><br><span class="line">	“_id”: ”<span class="number">93284847362823</span>”, <span class="comment">//variant sku, 商品编号</span></span><br><span class="line">	“itemId”: “<span class="number">30671</span>”, <span class="comment">//references the main item</span></span><br><span class="line">	“size”: <span class="number">6.0</span>,</span><br><span class="line">	“color”: “red”</span><br><span class="line">	…</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//通过它们的商品编号来快速检索到特定的商品系列 ???</span></span><br><span class="line">db.variation.find(&#123;_id:”<span class="number">93284847362823</span>”&#125;)</span><br><span class="line"><span class="comment">//通过对itemId  属性的查询获得某个特定商品的所有系列</span></span><br><span class="line">db.variation.find(&#123;itemId:”<span class="number">30671</span>”&#125;).sort(&#123;_id:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="不同店铺不同价格">不同店铺不同价格</h4><blockquote>
<p>Design: 将每个Price文档的_id设置为<strong>商品ID</strong>或者<strong>商品编号（SKU）</strong>的一个级联，<br>  并且将<strong>商店ID</strong>与价格变量相关联,<br>  这种方法也为处理价格提供很大的灵活性，因为它允许我们在商品或者系列级别对商品进行定价   </p>
<ul>
<li>商品：30671_store23  </li>
<li>某个特定规格的商品：93284847362823_store23<br>可以查询所有价格或者只是某个特定店铺的价格：</li>
<li>所有价格：db.prices.find({_id:/^30671/})  </li>
<li><p>某个特定店铺的价格：db.prices.find({_id:/^30671_store23/}) </p>
<p>可以添加其他组合，<br> 例如每个店铺群的价格，然后在单个查询中使用$in操作符获取对于一个商品而言所有可能的价格:</p>
</li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">db.prices.find(&#123;</span><br><span class="line">	_id:&#123;$<span class="keyword">in</span>:[ </span><br><span class="line">		“<span class="number">30671</span>_store23”,</span><br><span class="line">		“<span class="number">30671</span>_sgroup12”,</span><br><span class="line">		“<span class="number">93284847362823</span>_store23”,	</span><br><span class="line">		“<span class="number">93284847362823</span>_sgroup12” </span><br><span class="line">		]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="浏览和搜索商品">浏览和搜索商品</h4><blockquote>
<p>挑战：</p>
<pre><code><span class="bullet">* </span>响应时间：在用户浏览的同时，结果的每个页面应该在毫秒内返回  
<span class="bullet">* </span>多个属性：伴随着用户选择不同的方面（例如，品牌、大小、颜色等），新的查询必须能够在多个文档属性中运行  
<span class="bullet">* </span>系列级别属性：一些用户选择的属性将会在商品级别进行查询，
<span class="code">  例如品牌，但是其它的查询则有可能运行于系列级别上，例如尺寸。</span>
<span class="bullet">* </span>多个系列：每个商品都有可能有成千上万个系列，但是我们只希望每个商品只展示一次，因此，结果必须消除重复项。
<span class="bullet">* </span>排序：用户需要能够在多个属性上进行排序，例如价格、尺寸，此外排序操作必须能够高效运行。
<span class="bullet">* </span>分页：每个页面只返回少量结果，这就要求确定性排序。
</code></pre><p>Solution: MongoDB提供一个开源的[连接件项目][3]<br>  它允许MongoDB和Apache Solr以及Elasticsearch同时使用。<br>  然而，对于我们的参考架构，我们想完全在MongoDB中实现一个多方面搜索。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为了实现这个功能，我们创建了另一个集合，用于存储所谓的摘要文档。  </span></span><br><span class="line">  这些文档包含了我们需要基于多个搜索方面对产品目录中商品进行快速检索的所有信息。</span><br><span class="line">&#123;</span><br><span class="line">	“_id”: “<span class="number">30671</span>”,</span><br><span class="line">	“title”: “Evening Platform Pumps”,</span><br><span class="line">	“department”: “Shoes”,</span><br><span class="line">	“Category”: “Women/Shoes/Pumps”,</span><br><span class="line">	“price”: <span class="number">149.95</span>,</span><br><span class="line">	“attrs”: [“brand”: “Calvin Klein”, …],</span><br><span class="line">	“sattrs”: [“style”: ”Designer”, …],</span><br><span class="line">	“vars”: [</span><br><span class="line">		&#123;</span><br><span class="line">		“sku”: “<span class="number">93284847362823</span>”,</span><br><span class="line">		“attrs”: [&#123;“size”: <span class="number">6.0</span>&#125;, &#123;“color”: “red”&#125;, …],</span><br><span class="line">		“sattrs”: [&#123;“width”: <span class="number">8.0</span>&#125;, &#123;“heelHeight”: <span class="number">5.0</span>&#125;, …],</span><br><span class="line">		&#125;, … <span class="comment">//Many more SKUs</span></span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>通过使用这个数据模型，我们可以创建以下复合索引：<br>  假设用户将会选择部门来重新定义他们的搜索结果。<br>  对于没有部门的一个产品目录，我们可以非常轻易地从另一个像类别或者类型等比较普遍的方面开始。<br>  然后，我们可以执行需要进行多方面搜索的查询，并且快速将结果返回到页面：</p>
<ul>
<li>部门+属性+类别+ _id</li>
<li>部门+变量属性+类别+ _id</li>
<li>部门+类别+ _id</li>
<li>部门+价格+ _id</li>
<li>部门+评分+ _id</li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从商品ID获取摘要</span></span><br><span class="line">db.variation.find(&#123;_id:”<span class="number">30671</span>”&#125;)</span><br><span class="line"><span class="comment">//获取特定商品系列的摘要</span></span><br><span class="line">db.variation.find(&#123;vars.sku:”<span class="number">93284847362823</span>”&#125;,&#123;“vars.$”:<span class="number">1</span>&#125;)</span><br><span class="line"><span class="comment">//通过部门获取所有商品的摘要</span></span><br><span class="line">db.variation.find(&#123;department:”Shoes”&#125;)</span><br><span class="line"><span class="comment">//使用一系列混合的参数获取摘要</span></span><br><span class="line">db.variation.find(&#123; “department”:”Shoes”,“vars.attr”: &#123;“color”:”red”&#125;,“category”: “^<span class="regexp">/Shoes/</span>Women”&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="[库存优化方法][2]">[库存优化方法][2]</h3><blockquote>
<p>可以通过电商的店铺及应用访问到的、可靠的、集中的库存系统是提高和丰富用户体验中一个非常庞大的基础部分。</p>
</blockquote>
<h4 id="想要得到的一些特性：">想要得到的一些特性：</h4><ul>
<li>可靠地检查产品的实时库存</li>
<li>提供用户在某个指定实体店提货的选项</li>
<li>在某个商品有促销的情况下，判断每日补给的需求</li>
</ul>
<h4 id="设计原则">设计原则</h4><blockquote>
<p>电商参考架构中的库存系统应该要做的事情：<br>  需要的是构建一个高性能、可水平扩展的系统，<br>  在一个庞大的、地理分布的区域中的店铺和用户都能够与MongoDB进行实时交互来查看和更新目录。</p>
</blockquote>
<ul>
<li>提供一个库存的360°视图，可以在任何时间被任何客户端访问</li>
<li>能够被任何需要库存数据的系统使用</li>
<li>解决大数据量、以读取为主的工作负载，例如：库存检查</li>
<li>解决大数据量的实时写操作，例如：库存更新</li>
<li>支持批量写入操作以更新系统记录</li>
<li>地理上分离</li>
<li>伴随着库存中店铺数量或者商品数量的增多，保持水平扩展</li>
</ul>
<h4 id="店铺模式">店铺模式</h4><blockquote>
<p>用户案例的一个基本需求是为每个店铺维护一个关于所有库存的、集中的、实时的视图。<br>  首先需要为店铺集合创建视图，从而将的库存与地理位置相联系起来。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 每个店铺都使用一个相当直接的文档</span></span><br><span class="line">&#123;</span><br><span class="line">	“_id”:ObjectId(“<span class="number">78</span>s89453d8chw28h428f2423”),</span><br><span class="line">	“className”:”catalog.Store”,</span><br><span class="line">	“storeId”:”store100”,</span><br><span class="line">	“name”:”Bessemer Store”,</span><br><span class="line">	“address”:&#123;</span><br><span class="line">	“addr1”:”<span class="number">1</span> Main St.”,</span><br><span class="line">	“city”:”Bessemer”,</span><br><span class="line">	“state”:”AL”,</span><br><span class="line">	“zip”:”<span class="number">12345</span>”,</span><br><span class="line">	“country”:”USA”</span><br><span class="line">	&#125;,</span><br><span class="line">	“location”:[-<span class="number">86.95444</span>, <span class="number">33.40178</span>],</span><br><span class="line">	…</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建下列的索引来优化在店铺数据中最经常使用读取类型：</p>
<ul>
<li>{“storeId”:1},{“unique”:true}: 获取某个特定商店的库存</li>
<li>{“name”:1}:根据名字获取商店名称</li>
<li>{“address.zip”:1}: 获取一个邮编内的所有店铺，例如：店铺定位程序</li>
<li>{“location”: 2dsphere}:获取某一个特定地理位置周围的所有商店</li>
</ul>
</blockquote>
<h4 id="库存数据模型">库存数据模型</h4><blockquote>
<p>创建一个库存集合来跟踪每一个商品以及它们所有商品系列的真实库存量</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将数据从店铺集合复制到库存集合,最小化对数据库的来回读取数目,同时降低应用级的连接</span></span><br><span class="line"><span class="comment">// db.inventory</span></span><br><span class="line">&#123;</span><br><span class="line">	“_id”:”<span class="number">902372093572409542</span>jbf42r2f2432”,</span><br><span class="line">	“storeId”:”store100”,				<span class="comment">// 知道哪个商店有什么商品是非常必要的</span></span><br><span class="line">	“location”:[-<span class="number">86.95444</span>, <span class="number">33.40178</span>],	<span class="comment">// 查询离用户附近的库存</span></span><br><span class="line">	“productId”:”<span class="number">20034</span>”,  				<span class="comment">// </span></span><br><span class="line">	“vars”:[</span><br><span class="line">		&#123;“sku”:”sku1”, “quantity”:”<span class="number">5</span>”&#125;,  <span class="comment">// 在商品级别文档中表示库存 </span></span><br><span class="line">		&#123;“sku”:”sku2”, “quantity”:”<span class="number">23</span>”&#125;, <span class="comment">// 更大的文档以降低数据冗余度，可以减少在库存集合中需要查询或者更新的文档总数</span></span><br><span class="line">		&#123;“sku”:”sku3”, “quantity”:”<span class="number">2</span>”&#125;,</span><br><span class="line">		…</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建索引</p>
<ul>
<li>{storeId:1}: 得到某一个指定商店库存中的所有商品</li>
<li>{productId:1},{storeId:1}: 获取一个指定店铺中某个产品的库存</li>
<li>{productId:1},{location:”2dsphere”}:获取在一定距离之内的某个产品的所有库存</li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以基于’productID’查询我们的库存了</span></span><br><span class="line">db.inventory.find(&#123;</span><br><span class="line">	“storeId”:”store100”,</span><br><span class="line">	“productId”:“<span class="number">20034</span>”,</span><br><span class="line">	“vars.sku”:”sku11736”</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;“vars.$”:<span class="number">1</span>&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="Reference">Reference</h3><p><a href="http://www.mongoing.com/blog/retail-reference-architecture-part-1" target="_blank" rel="external">1</a><br><a href="http://www.mongoing.com/blog/retail-reference-architecture-part-2-approaches-inventory-optimization" target="_blank" rel="external">2</a><br><a href="http://blog.mongodb.org/post/29127828146/introducing-mongo-connector" target="_blank" rel="external">3</a> </p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>电商参考架构</p>
</blockquote>
<h3 id="[搭建灵活-可搜索-响应快速的产品目录系统][1]">[搭建灵活-可搜索-响应快速的产品目录系统][1]</h3><blockquote>
<p>大数据量电商如何使用MongoDB作]]>
    </summary>
    
      <category term="MongoDB, eCommerce, Product Catlog,  Inventory" scheme="http://strong689.github.com/tags/MongoDB-eCommerce-Product-Catlog-Inventory/"/>
    
      <category term="MongoDB" scheme="http://strong689.github.com/categories/MongoDB/"/>
    
      <category term="Design" scheme="http://strong689.github.com/categories/MongoDB/Design/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Step into MongoDB II - Industry Sample]]></title>
    <link href="http://strong689.github.com/2015/07/17/Step-into-MongoDB-II-Industry-Sample/"/>
    <id>http://strong689.github.com/2015/07/17/Step-into-MongoDB-II-Industry-Sample/</id>
    <published>2015-07-18T06:32:11.000Z</published>
    <updated>2015-07-19T22:19:57.904Z</updated>
    <content type="html"><![CDATA[<h3 id="[快的打车][1]">[快的打车][1]</h3><ul>
<li><p>场景</p>
<blockquote>
<p>1亿多用户，超过300个城市里与300万司机取得了联系<br>两类业务：快的出租车 &amp; 快的一号专车<br>司机与乘客每天高达6百万次的联系<br>管理着将近5亿的订单<br>支持着每秒钟数以万计的读写操作<br>MongoDB每秒支持着5万个操作（读取和写入的比例约为80:20）<br>数据库已经增长到5亿多文档，并且还在持续扩展中  </p>
</blockquote>
</li>
<li><p>应用</p>
<blockquote>
<p>选择指标：性能(延迟、实时更新的速度),可扩展性,易用性<br>LBS ： MongoDB的地理空间索引及查询<br>可扩展性,历史订单数据的存档：顾客每呼叫一辆出租车，行程的起点及终点、司机的身份以及费用等都会被存储在一条单一的记录中<br>Redis 缓存<br>MySQL 存储顾客运营及订单数据<br>Hadoop 将数据从MongoDB和MySQL中拷贝到Hadoop上进行挖掘及分析<br>使用Nagios来监测应用及数据库<br>使用Java驱动来运行MongoDB2.6  </p>
</blockquote>
</li>
</ul>
<h3 id="[盛大大数据量项目中的应用][2]">[盛大大数据量项目中的应用][2]</h3><blockquote>
<p> Best Practices<br>Replica Set: one for primary, one for secondary, one for increamental back up with  a arbiter</p>
</blockquote>
<h3 id="[电影票预定系统_design_idea][3]">[电影票预定系统 design idea][3]</h3><h4 id="需求">需求</h4><blockquote>
<p>每个场次，每个座位，都只有一个库存<br>每个订单所预定的座位有锁定状态，在支付前对应的作为不能被再次购买<br>订单涉及到的座位要不全成功，要不全失败<br>“全国”级的，数据容量不是太大问题，但性能上要支持水平扩展  </p>
</blockquote>
<h4 id="描述信息文档结构">描述信息文档结构</h4><ul>
<li><p>影院描述</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">CinemaManager.cinema_detail&#123;</span><br><span class="line">	_id:ObjectId,</span><br><span class="line">	name:<span class="built_in">String</span>,</span><br><span class="line">	city:<span class="built_in">String</span>,</span><br><span class="line">	location: [,],  <span class="comment">// [ 120.13, 30.16 ], coordinate</span></span><br><span class="line">	comments:<span class="built_in">String</span></span><br><span class="line">&#125;</span><br><span class="line">db.cinema_detail.ensureIndex(&#123;city:<span class="number">1</span>, name:<span class="number">1</span>&#125;)&#123;</span><br><span class="line">	<span class="string">"createdCollectionAutomatically"</span> : <span class="literal">false</span>,</span><br><span class="line">	<span class="string">"numIndexesBefore"</span> : <span class="number">2</span>,</span><br><span class="line">	<span class="string">"numIndexesAfter"</span> : <span class="number">2</span>,</span><br><span class="line">	<span class="string">"ok"</span> : <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">db.cinema_detail.ensureIndex(&#123;location: <span class="string">"2d"</span>&#125;)&#123;</span><br><span class="line">	<span class="string">"createdCollectionAutomatically"</span> : <span class="literal">false</span>,</span><br><span class="line">	<span class="string">"numIndexesBefore"</span> : <span class="number">3</span>,</span><br><span class="line">	<span class="string">"numIndexesAfter"</span> : <span class="number">4</span>,</span><br><span class="line">	<span class="string">"ok"</span> : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>影厅描述</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CinemaManager.theater_detail&#123;</span><br><span class="line">	_id,</span><br><span class="line">	cinema_id,</span><br><span class="line">	name:<span class="built_in">String</span>,</span><br><span class="line">	seat:&#123;</span><br><span class="line">		row1:[],</span><br><span class="line">		row2:[],</span><br><span class="line">		row3:[],</span><br><span class="line">		...</span><br><span class="line">	&#125;,</span><br><span class="line">	comments:<span class="built_in">String</span></span><br><span class="line">&#125;</span><br><span class="line">db.theater_detail.ensureIndex(&#123;cinema_id:<span class="number">1</span>&#125;)&#123;</span><br><span class="line">	<span class="string">"createdCollectionAutomatically"</span> : <span class="literal">false</span>,</span><br><span class="line">	<span class="string">"numIndexesBefore"</span> : <span class="number">1</span>,</span><br><span class="line">	<span class="string">"numIndexesAfter"</span> : <span class="number">2</span>,</span><br><span class="line">	<span class="string">"ok"</span> : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>影片描述</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CinemaManager.movie_detail&#123;</span><br><span class="line">	_id,</span><br><span class="line">	name:<span class="built_in">String</span>,</span><br><span class="line">	director:<span class="built_in">String</span>,</span><br><span class="line">	actors:[],</span><br><span class="line">	comments:<span class="built_in">String</span></span><br><span class="line">&#125;</span><br><span class="line">db.movie_detail.ensureIndex(&#123;name:<span class="number">1</span>&#125;)&#123;</span><br><span class="line">	<span class="string">"createdCollectionAutomatically"</span> : <span class="literal">false</span>,</span><br><span class="line">	<span class="string">"numIndexesBefore"</span> : <span class="number">1</span>,</span><br><span class="line">	<span class="string">"numIndexesAfter"</span> : <span class="number">2</span>,</span><br><span class="line">	<span class="string">"ok"</span> : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="影片放映文档结构">影片放映文档结构</h4><blockquote>
<p> 放映信息包含放映时间段，放映影厅，票价。虽然Document结构可以做复杂的嵌套，但原则上期望Document尽量小，<br>利用数据Shard，性能优化。所以在movie_schedule的设计上每个影片的每场放映独立一个Document表达。</p>
</blockquote>
<ul>
<li>描述<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CinemaManager.movie_schedule&#123;</span><br><span class="line">	_id,</span><br><span class="line">	cinema_id,</span><br><span class="line">	movie_id,</span><br><span class="line">	theater_id,</span><br><span class="line">	start_time:</span><br><span class="line">	end_time,</span><br><span class="line">	comments:<span class="built_in">String</span></span><br><span class="line">&#125;</span><br><span class="line">db.movie_schedule.ensureIndex(&#123;cinema_id:<span class="number">1</span>, movie_id:<span class="number">1</span>, theater_id:<span class="number">1</span>&#125;)&#123;</span><br><span class="line">	<span class="string">"createdCollectionAutomatically"</span> : <span class="literal">false</span>,</span><br><span class="line">	<span class="string">"numIndexesBefore"</span> : <span class="number">1</span>,</span><br><span class="line">	<span class="string">"numIndexesAfter"</span> : <span class="number">2</span>,</span><br><span class="line">	<span class="string">"ok"</span> : <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="交易系统">交易系统</h4><blockquote>
<p>抽象的来看，售卖系统就是对上诉所有集合的一个整合，外加一套库存字段。<br>我们认为一场放映就是一个主商品，每个座位可以认为是这个商品的SKU，每个SKU都是1份。<br>通过Reference关系结合movie_schedule与theater_detail，注意这里引用了</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	_id: ,</span><br><span class="line">	movie_schedule_id:</span><br><span class="line">	theater_id: ,</span><br><span class="line">	seat:	&#123;</span><br><span class="line">		row1: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">		row2: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">		row3: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">		row4: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不仅是Reference的引用关系，还复制了theater_detail.seat字段，每个seat都有一个库存数字，<br>因为在MongoDB中一个Document的操作是可以保证原子的，不需要对Collection加任何锁。数字2并不是表示可以卖2次：</p>
<ul>
<li>数字2表示，可销售</li>
<li>数字1表示，已锁定</li>
<li>数字0表示，已售完</li>
</ul>
</blockquote>
<h3 id="From">From</h3><p><a href="http://www.mongoing.com/blog/kuaidi-interview" target="_blank" rel="external">1</a><br><a href="http://www.mongoing.com/blog/national-tickets-order-system" target="_blank" rel="external">2</a><br><a href="http://www.infoq.com/cn/presentations/glj-mongodb-in-sdo" target="_blank" rel="external">3</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="[快的打车][1]">[快的打车][1]</h3><ul>
<li><p>场景</p>
<blockquote>
<p>1亿多用户，超过300个城市里与300万司机取得了联系<br>两类业务：快的出租车 &amp; 快的一号专车<br>司机与乘客每天高达6百万次的]]>
    </summary>
    
      <category term="MongoDB" scheme="http://strong689.github.com/tags/MongoDB/"/>
    
      <category term="Schema" scheme="http://strong689.github.com/tags/Schema/"/>
    
      <category term="Schema Design" scheme="http://strong689.github.com/tags/Schema-Design/"/>
    
      <category term="MongoDB" scheme="http://strong689.github.com/categories/MongoDB/"/>
    
      <category term="Design" scheme="http://strong689.github.com/categories/MongoDB/Design/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Step into MongoDB I - Overview]]></title>
    <link href="http://strong689.github.com/2015/07/16/Step-into-MongoDB-I-Overview/"/>
    <id>http://strong689.github.com/2015/07/16/Step-into-MongoDB-I-Overview/</id>
    <published>2015-07-17T05:31:31.000Z</published>
    <updated>2015-07-19T22:20:15.061Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>Hu<strong>mongo</strong>us, MongoDB = JSON +Index  </p>
</blockquote>
<h2 id="Features">Features</h2><blockquote>
<p>document/Object/collection oriented, JSON/BSON, Key/Value, fully indexed(object)<br>Replication &amp; High Availability, Rich Document based Query and Update<br>auto-sharding(sharding key) &amp; GridFS, Map/Reduce  </p>
</blockquote>
<h3 id="ReplicaSet">ReplicaSet</h3><blockquote>
<p>Basically master/slave replication<br>automatic fail-over to recovery member nodes<br>consists of two or more nodes that are copies of each other<br>automatically elects a primary(master) if there is no primary currently available<br>Distribute read load<br>arbiter  </p>
</blockquote>
<h3 id="Monitoring_&amp;_Diagnostics">Monitoring &amp; Diagnostics</h3><ul>
<li>query profiler</li>
<li>Http console</li>
<li>mongostat</li>
<li>Memory-mapping, keep indexes in memory</li>
<li>oplog {ts:{},h{}, op:{},ns:{},o:{},o2:{}}, local, db.oplog.</li>
</ul>
<h3 id="backup">backup</h3><ul>
<li>mongoexport, monogoimport</li>
<li>mongodump mongorestore</li>
<li>data consistency use —oplog</li>
<li>use increamental backup </li>
<li>read oplog and replay(wordnik tools)</li>
</ul>
<h3 id="Rollback_MongoDB">Rollback MongoDB</h3><ul>
<li>Use snapshot + oplog</li>
<li>Use delayed secondary + oplog</li>
</ul>
<h3 id="Ops">Ops</h3><ul>
<li>Scala up : Vertical</li>
<li>Scale out: horizontal / auto sharding</li>
<li>build new index in a huge collections</li>
</ul>
<h2 id="Scenario">Scenario</h2><ul>
<li>real time  CRUD, web 2.0</li>
<li>buffer, persistent buffer</li>
<li>big data, web log</li>
<li>db cluster </li>
</ul>
<h3 id="others">others</h3><blockquote>
<p>no transaction support</p>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>Hu<strong>mongo</strong>us, MongoDB = JSON +Index  </p>
</blockquote>
<h2 id="Features">Features</h2><blockquote>
<p>documen]]>
    </summary>
    
      <category term="MongoDB, Replica Set," scheme="http://strong689.github.com/tags/MongoDB-Replica-Set/"/>
    
      <category term="MongoDB" scheme="http://strong689.github.com/categories/MongoDB/"/>
    
      <category term="Overview" scheme="http://strong689.github.com/categories/MongoDB/Overview/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Step into Markdown]]></title>
    <link href="http://strong689.github.com/2015/07/15/Step-into-Markdown/"/>
    <id>http://strong689.github.com/2015/07/15/Step-into-Markdown/</id>
    <published>2015-07-16T05:21:43.000Z</published>
    <updated>2015-07-19T22:21:33.522Z</updated>
    <content type="html"><![CDATA[<h4 id="Italics_and_Bold">Italics and Bold</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">** _</span><br></pre></td></tr></table></figure>
<h4 id="Header">Header</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ## ### #### ...</span><br><span class="line">#### _italics header five_</span><br></pre></td></tr></table></figure>
<h4 id="Links">Links</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[visit url](url)</span><br></pre></td></tr></table></figure>
<ul>
<li>inline link <a href=""></a></li>
<li>reference link [][]</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Find something by your [<span class="link_label">favorites search engine</span>][<span class="link_reference">favorite</span>];</span><br><span class="line">or try [<span class="link_label">another</span>][<span class="link_reference">alternative</span>].</span><br><span class="line"><span class="code">	</span></span><br><span class="line">[<span class="link_reference">favorite</span>]:<span class="link_url">www.google.com</span></span><br><span class="line">[<span class="link_reference">alternative</span>]:<span class="link_url">www.bing.com</span></span><br></pre></td></tr></table></figure>
<h4 id="Images">Images</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![](url "alt text")</span><br></pre></td></tr></table></figure>
<ul>
<li>inline image</li>
<li>reference image<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   //inline style</span><br><span class="line">![text](url "alt text")</span><br><span class="line">//reference style</span><br><span class="line">![text][logo]</span><br><span class="line"></span><br><span class="line">[logo]:url 'alt text'</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="block_quotes_&gt;">block quotes &gt;</h4><pre><code>&gt; this <span class="keyword">is</span> a <span class="keyword">block</span> quotes <span class="keyword">to</span> <span class="keyword">notify</span> reader pay special attention
</code></pre><h4 id="Lists_*">Lists *</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* + -</span><br></pre></td></tr></table></figure>
<h4 id="Paragraphs">Paragraphs</h4><ul>
<li>hard break</li>
<li>soft break : two spaces after each new line</li>
</ul>
<h4 id="Code_`">Code `</h4><blockquote>
<p>sample 1<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str =<span class="string">"test"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str)</span><br></pre></td></tr></table></figure></p>
<p>sample 2<br>Inline <code>code</code> test <code>var num = 123</code> , good sample.<br>sample 3<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$npm</span> install express -g</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="Tablestables_is_not_part_of_core_Markdown_spec-_by_GFM_spec?">Tablestables is not part of core Markdown spec. by GFM spec?</h4><h4 id="Horizontal_rule">Horizontal rule</h4><blockquote>
<p>three or more - * _  hyphen Asterisks underscore</p>
</blockquote>
<h4 id="inline_HTML_support">inline HTML support</h4><h4 id="youtube_videos_sample">youtube videos sample</h4><blockquote>
<p>sample<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">iframe</span> <span class="attribute">width</span>=<span class="value">"560"</span> <span class="attribute">height</span>=<span class="value">"315"</span> <span class="attribute">src</span>=<span class="value">"https://www.youtube.com/embed/6A5EpqqDOdk"</span> <span class="attribute">frameborder</span>=<span class="value">"0"</span> <span class="attribute">allowfullscreen</span>&gt;</span><span class="tag">&lt;/<span class="title">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
 <iframe width="560" height="315" src="https://www.youtube.com/embed/6A5EpqqDOdk" frameborder="0" allowfullscreen></iframe>

]]></content>
    <summary type="html">
    <![CDATA[<h4 id="Italics_and_Bold">Italics and Bold</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span>]]>
    </summary>
    
      <category term="Markdown" scheme="http://strong689.github.com/tags/Markdown/"/>
    
      <category term="Markdown" scheme="http://strong689.github.com/categories/Markdown/"/>
    
      <category term="Overview" scheme="http://strong689.github.com/categories/Markdown/Overview/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[互联网+]]></title>
    <link href="http://strong689.github.com/2015/07/14/Internet-Plus/"/>
    <id>http://strong689.github.com/2015/07/14/Internet-Plus/</id>
    <published>2015-07-15T06:47:23.000Z</published>
    <updated>2015-07-19T22:12:57.602Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>中国传统企业+Internet</p>
</blockquote>
<h2 id="互联网">互联网</h2><ul>
<li>互联网思维</li>
<li>互联网平台/生态</li>
<li>互联网渠道</li>
<li>万物互联 / 物联网<blockquote>
<p>   传统行业: 交易,金融,地产,音乐,娱乐…<br>  +信息 +交易 +….  //online 上线/线上</p>
</blockquote>
</li>
</ul>
<h3 id="=&gt;_营销渠道">=&gt; 营销渠道</h3><h2 id="+">+</h2><ul>
<li>+政策 &amp; +人才</li>
<li>+技术<br>  移动互联 与计算 大数据 物联网<br>  LBS NFC Bluetooth<br>  O2O</li>
</ul>
<h3 id="=&gt;_+服务">=&gt; +服务</h3>]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>中国传统企业+Internet</p>
</blockquote>
<h2 id="互联网">互联网</h2><ul>
<li>互联网思维</li>
<li>互联网平台/生态</li>
<li>互联网渠道</li>
<li>万物互联 / 物联网<b]]>
    </summary>
    
      <category term="IoT" scheme="http://strong689.github.com/tags/IoT/"/>
    
      <category term="IoT" scheme="http://strong689.github.com/categories/IoT/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Step into Jadejs]]></title>
    <link href="http://strong689.github.com/2015/07/14/Step-into-Jadejs/"/>
    <id>http://strong689.github.com/2015/07/14/Step-into-Jadejs/</id>
    <published>2015-07-15T05:11:29.000Z</published>
    <updated>2015-07-19T22:21:36.355Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>Node Template Engine, a terse language for writing HTML templates, support dynamic code and reusability.</p>
<h1 id="Installation_&amp;_API">Installation &amp; API</h1><ul>
<li>Installation<br>  $ npm install jade -g</li>
<li>API<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">var</span> jade <span class="built_in">require</span>(<span class="string">"jade"</span>);</span><br><span class="line"><span class="keyword">var</span> fn = jade.compile(<span class="string">'string of jade'</span>,options);</span><br><span class="line">fn(locals);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<h1 id="Jade_command_line">Jade command line</h1><pre><code>$ jade [-<span class="literal">options</span>] [<span class="keyword">file</span>]
$ jade layout.jade //compile layout.jade <span class="keyword">file</span> to layout.html <span class="keyword">file</span>
$ jade layout      //compile whole <span class="string">"layout"</span> <span class="literal">directory</span> 
</code></pre><h1 id="Jade_Syntax">Jade Syntax</h1><h2 id="Common">Common</h2><ul>
<li>doctype html/xml/… e.g.-&gt; &lt;!DOCTYPE html&gt;; </li>
<li>Indented style</li>
<li>text at the start of line represents an html tag</li>
<li>self closing tags(img,meta, link…) and explicitly self close (appending /, e.g. abc/ -&gt; <abc>)</abc></li>
</ul>
<h2 id="Attributes">Attributes</h2><ul>
<li>By default, all attributes are escaped, unescapeded attributes need use != instead of =, use !{name} instead of #{name}.</li>
<li>&amp;attributes can be used to explode an object into attributes of an element, it’s not escaped by default</li>
<li>Boolean/Style/Class attributes</li>
<li>Class/ID Literal</li>
</ul>
<h2 id="Text/PlainText">Text/PlainText</h2><hr>
<h3 id="Piped_Text_|">Piped Text |</h3><pre><code>|  <span class="comment">//to prefix the line with a | character(pipe)</span>
</code></pre><h3 id="HTML_Tags">HTML Tags</h3><h4 id="Inline_in_a_Tag">Inline in a Tag</h4><pre><code><span class="tag">p</span> <span class="tag">h1</span> <span class="tag">h2</span> ... script  
</code></pre><h4 id="Block_in_a_Tag">Block in a Tag</h4><pre><code><span class="tag">p</span>. <span class="tag">h1</span>. script.  ....
</code></pre><h2 id="JS_Code_support">JS Code support</h2><ul>
<li><p>prefix - / unbuffered code &amp; block unbuffered code</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   - var foo = "foo";</span><br><span class="line">-</span><br><span class="line">  each item in list</span><br><span class="line">    li= item</span><br></pre></td></tr></table></figure>
</li>
<li><p>prefix = / buffered code ; support JS expressions</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   h1= foo</span><br><span class="line">= foo</span><br><span class="line">p=list</span><br></pre></td></tr></table></figure>
</li>
<li><p>unescaped buffered code<br>  p!= “This is “ + “<em>unescaped</em>“</p>
</li>
<li>Jade naturely support if, else, else if, until, while , unless</li>
</ul>
<h2 id="basic_controls">basic controls</h2><hr>
<h3 id="if,_unless">if, unless</h3><pre><code><span class="keyword">if</span> <span class="property">name</span> == <span class="string">"xyz"</span>
  h1 hello xyz
<span class="keyword">else</span>
  h1 My Name <span class="keyword">is</span> <span class="comment">#{name}</span>
</code></pre><h3 id="for,_each,_while">for, each, while</h3><pre><code><span class="keyword">select
</span>  each <span class="keyword">book, </span>i in <span class="keyword">books
</span>    option(value<span class="label">=i</span>) <span class="keyword">Book </span>#{<span class="keyword">book}
</span><span class="label">ul</span>
  for <span class="keyword">book </span>in <span class="keyword">books
</span>    li= <span class="keyword">book
</span>  <span class="preprocessor">else</span>
    li no <span class="keyword">books!</span>
</code></pre><h3 id="case">case</h3><pre><code>case month
when 1
  p January
when 2
  p February
other
  p Month : #{month}
</code></pre><h2 id="extends_&amp;_inheritance">extends &amp; inheritance</h2><hr>
<h3 id="extends">extends</h3><pre><code><span class="keyword">extends</span> .<span class="regexp">/view/</span>layout.jade
</code></pre><h3 id="block">block</h3><ul>
<li>block, by default, will be replaced within a child template, it’s a recursive process</li>
<li>(block) append</li>
<li>(block) prepend</li>
</ul>
<h3 id="include">include</h3><ul>
<li>insert the contents of one jade file into another</li>
<li>plain text file</li>
<li>js/css</li>
<li>filtered text<br> include:markdown article.md</li>
</ul>
<h2 id="interpolation">interpolation</h2><hr>
<h3 id="String_Interpolation,_escaped">String Interpolation, escaped</h3><pre><code>-<span class="ruby">var msg = <span class="string">""</span>;
</span>h1= msg
p This is #{<span class="ruby">msg}</span>
</code></pre><h3 id="String_Interpolation,_Unescaped">String Interpolation, Unescaped</h3><pre><code><span class="change">!{msg}</span>
</code></pre><h3 id="Tag_Interpolation,_#[_]">Tag Interpolation, #[ ]</h3><pre><code><span class="tag">p</span>. 
  Please visit my blog on 
   #[<span class="function"><span class="title">a</span><span class="params">(target=<span class="string">"_blank"</span>, href=<span class="string">"https://strong689.github.io"</span>)</span></span> GitHub]
</code></pre><h2 id="Mixins">Mixins</h2><hr>
<p>to create reusable blocks of jade</p>
<h3 id="Mixins_decalration_&amp;_reuse">Mixins decalration &amp; reuse</h3><pre><code><span class="comment">// Declaration</span>
mixin myfooter
  <span class="tag">ul</span> 
    <span class="tag">li</span> <span class="function"><span class="title">a</span><span class="params">(href=<span class="string">"abc.com"</span>)</span></span> about me
    <span class="tag">li</span> <span class="function"><span class="title">a</span><span class="params">(href=<span class="string">"/privacy.html"</span>)</span></span> privary
    <span class="tag">li</span> <span class="function"><span class="title">a</span><span class="params">(href=<span class="string">"/home.html"</span>)</span></span> home
mixin <span class="function"><span class="title">myfunction</span><span class="params">(para)</span></span>
    <span class="tag">li</span>.classname= para    
<span class="comment">// use</span>
+myfooter
+<span class="function"><span class="title">myfunction</span><span class="params">(<span class="string">"abc"</span>)</span></span>
</code></pre><h3 id="mixin_blocks">mixin blocks</h3><pre><code>mixin product(name)
  .product
    h1= name
    <span class="keyword">if</span> block
      block
    <span class="keyword">else</span>
      <span class="keyword">p</span> <span class="keyword">no</span> product detail

+product(<span class="string">"samsung galaxy III"</span>)
+product(<span class="string">"iphone')
</span>  <span class="keyword">p</span> old <span class="keyword">version</span>
  <span class="keyword">p</span> amazing product
</code></pre><h3 id="Mixin_Attributes">Mixin Attributes</h3><pre><code><span class="comment">//declaration</span>
mixin <span class="function"><span class="title">link</span><span class="params">(href,name)</span></span>
  <span class="comment">//- attributes == {class:"btn"}</span>
  <span class="function"><span class="title">a</span><span class="params">(class!=attributes.class, href=href)</span></span>= name

<span class="comment">//use</span>
+<span class="function"><span class="title">link</span><span class="params">(<span class="string">'/foo'</span>,<span class="string">'foo'</span>)</span><span class="params">(class=<span class="string">'btn'</span>)</span></span>
</code></pre><h3 id="Rest_Arguments">Rest Arguments</h3><pre><code><span class="comment">//declaration</span>
mixin <span class="function"><span class="title">list</span><span class="params">(id, ...items)</span></span>
  <span class="function"><span class="title">ul</span><span class="params">(id=id)</span></span>
    each item <span class="keyword">in</span> items
      li= item
<span class="comment">//to use</span>
+<span class="function"><span class="title">list</span><span class="params">(<span class="string">'mylist'</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span></span>
</code></pre><h2 id="Comments">Comments</h2><ul>
<li>single line comment //same like JS comments</li>
<li>invisible single line comments //-adding a hyphen</li>
<li>block comment, indented after the first line comment</li>
<li>normal HTML style conditional comments , e.g.  <!--[if IE]> 
  script(src='/ie.js') 
  <![endif]-->
</li>
</ul>
<h2 id="Resources">Resources</h2><p><a href="http://jade-lang.com/" target="_blank" rel="external">JADE</a><br><a href="http://naltatis.github.io/jade-syntax-docs/#basics" target="_blank" rel="external">Jade Syntax - interactive demo</a><br><a href="http://segmentfault.com/a/1190000000357534#articleHeader0" target="_blank" rel="external">Segmentfault</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>Node Template Engine, a terse language for writing HTML templates, support dynamic code and reusability.</p>
<h1 id="Install]]>
    </summary>
    
      <category term="Jadejs Markdown" scheme="http://strong689.github.com/tags/Jadejs-Markdown/"/>
    
      <category term="Jadejs" scheme="http://strong689.github.com/categories/Jadejs/"/>
    
      <category term="Overview" scheme="http://strong689.github.com/categories/Jadejs/Overview/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Build a Blog by Hexo + GitHub]]></title>
    <link href="http://strong689.github.com/2015/07/13/Build-a-Blog-by-Hexo-GitHub/"/>
    <id>http://strong689.github.com/2015/07/13/Build-a-Blog-by-Hexo-GitHub/</id>
    <published>2015-07-14T06:02:57.000Z</published>
    <updated>2015-07-19T22:21:18.814Z</updated>
    <content type="html"><![CDATA[<h1 id="Hexo_+_GitHub">Hexo + GitHub</h1><h2 id="Hexojs">Hexojs</h2><blockquote>
<p>A fast, simple &amp; powerful blog framework, powered by Node.js.</p>
<h3 id="Installation">Installation</h3><pre><code><span class="label">$npm</span> install hexo-<span class="keyword">cli</span> -<span class="keyword">g</span>
<span class="label">$npm</span> <span class="keyword">update</span> hexo -<span class="keyword">g</span>
</code></pre><h3 id="Few_commands_to_start">Few commands to start</h3><h4 id="setup_your_blog">setup your blog</h4><pre><code>$ hexo init your_blog <span class="regexp">//</span> your_blog <span class="keyword">is</span> a <span class="keyword">new</span> directory
$ cd your_blog
$ <span class="built_in">npm</span> install 
</code></pre><h4 id="create_a_new_post">create a new post</h4><pre><code><span class="variable">$hexo</span> <span class="literal">new</span> <span class="string">"hello world"</span>
</code></pre><h4 id="run_server_/_deploy_local">run server / deploy local</h4><pre><code><span class="variable">$hexo</span> server  // http://localhost:<span class="number">4000</span>, <span class="keyword">default</span> <span class="keyword">port</span>; _config.yml
</code></pre><h4 id="generate_static_files">generate static files</h4><pre><code><span class="label">$hexo</span> <span class="keyword">generate</span>    <span class="comment">// public folder, </span>
</code></pre><h4 id="Deploy_to_remote_sites">Deploy to remote sites</h4><pre><code><span class="variable">$hexo</span> deploy
</code></pre><h3 id="Resources_&amp;_Features">Resources &amp; Features</h3><p><a href="https://hexo.io/" target="_blank" rel="external">Hexo.io</a><br><a href="https://github.com/hexojs/hexo" target="_blank" rel="external">Hexo GitHub</a></p>
</blockquote>
<h2 id="Deploy_blog_to_GitHub">Deploy blog to GitHub</h2><h3 id="Personalize/Config_Blog">Personalize/Config Blog</h3><ul>
<li>Modify _config.yml</li>
<li>change theme  <a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external">Theme Next</a></li>
<li>$git clone <a href="https://github.com/iissnan/hexo-theme-next.git" target="_blank" rel="external">https://github.com/iissnan/hexo-theme-next.git</a></li>
</ul>
<h3 id="Hexo_GitHub_Deployer">Hexo GitHub Deployer</h3><pre><code>$ npm <span class="operator"><span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></span>
</code></pre><h3 id="Feed_Support">Feed Support</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$npm</span> install hexo-generator-feed --save</span><br></pre></td></tr></table></figure>
<h3 id="Category_Support">Category Support</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$npm</span> install hexo-generator-category --save</span><br></pre></td></tr></table></figure>
<h3 id="Steps">Steps</h3><ol>
<li>apply an GitHub “account”</li>
<li>create a new Repository (GitHubPage name use “account.github.com” or “acount.github.io”)</li>
<li>config Hexo github address _config.yml<pre>
# Deployment
## Docs: http://hexo.io/docs/deployment.html
deploy:
type: git
repository: https://github.com/account/account.github.io.git
> e.g. https://github.com/Strong689/strong689.github.com.git
branch: master> visit: [Step by step Leaning](http://strong689.github.com) or [Blog at GitHub.io](http://strong689.github.io)
</pre></li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="Hexo_+_GitHub">Hexo + GitHub</h1><h2 id="Hexojs">Hexojs</h2><blockquote>
<p>A fast, simple &amp; powerful blog framework, powered by]]>
    </summary>
    
      <category term="Hexo, Blog" scheme="http://strong689.github.com/tags/Hexo-Blog/"/>
    
      <category term="Overview" scheme="http://strong689.github.com/categories/Overview/"/>
    
      <category term="Hexo" scheme="http://strong689.github.com/categories/Overview/Hexo/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello World]]></title>
    <link href="http://strong689.github.com/2015/07/09/hello-world/"/>
    <id>http://strong689.github.com/2015/07/09/hello-world/</id>
    <published>2015-07-10T05:11:29.000Z</published>
    <updated>2015-07-19T22:12:45.467Z</updated>
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io]]>
    </summary>
    
      <category term="Hexo" scheme="http://strong689.github.com/categories/Hexo/"/>
    
  </entry>
  
</feed>